{%- assign product = all_products[section.settings.product_handle] | default: product -%}
<!-- Updated: May 1, 2024 -->

{% render 'hyperlab-global-styles' %}

<div class="hyperlab-section hyperlab-bg-white">
  <div class="hyperlab-content">
    <div class="hyperlab-v10-hero {% if section.settings.full_width %}full-width{% endif %}">
      <div class="hero-content {% if section.settings.full_width %}page-width{% endif %}">
        <div class="hero-header">
          <div class="logo-container">
            {%- if section.settings.logo != blank -%}
              <img src="{{ section.settings.logo | img_url: '100x' }}" alt="{{ shop.name }}" class="hero-logo">
            {%- endif -%}
          </div>
          
          <h1 class="hero-title">{{ section.settings.headline | default: "¿TUS HIJOS NO ESTÁN COMIENDO BIEN?" }}</h1>
        </div>

        <div class="product-gallery">
          <div class="gallery-container">
            <div class="main-image-wrapper">
              <button class="gallery-nav prev" aria-label="Previous image">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
              
              <div class="main-image-container">
                <div class="main-image">
                  {%- if section.settings.image_1 != blank -%}
                    <img src="{{ section.settings.image_1 | img_url: '1000x' }}" 
                         alt="{{ section.settings.image_1.alt | escape }}"
                         class="featured-image"
                         data-index="0">
                  {%- endif -%}
                </div>
              </div>

              <button class="gallery-nav next" aria-label="Next image">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>

            <div class="thumbnails-container">
              {%- for i in (1..5) -%}
                {%- assign image_setting = 'image_' | append: i -%}
                {%- assign current_image = section.settings[image_setting] -%}
                {%- if current_image != blank -%}
                  <button class="thumbnail-button {% if forloop.first %}active{% endif %}" 
                          data-image-url="{{ current_image | img_url: '1000x' }}"
                          data-image-index="{{ forloop.index0 }}"
                          data-alt="{{ current_image.alt | escape }}">
                    <img src="{{ current_image | img_url: '100x100', crop: 'center' }}" 
                         alt="{{ current_image.alt | escape }}"
                         class="thumbnail-image">
                  </button>
                {%- endif -%}
              {%- endfor -%}
            </div>
          </div>
        </div>

        <div class="hero-cta">
          <div class="subheadline-container">
            <h2 class="subheadline">{{ section.settings.subheadline | default: "¡NO TE PREOCUPES MÁS!" }}</h2>
            {%- if section.settings.certification_badge != blank -%}
              <div class="certification-badge">
                <img src="{{ section.settings.certification_badge | img_url: '100x' }}" 
                     alt="Certificación INVIMA" 
                     class="certification-image">
              </div>
            {%- endif -%}
          </div>
          <a href="{{ section.settings.button_link | default: '#' }}" class="primary-button {{ section.settings.button_animation }}">
            {{ section.settings.button_text | default: "CLICK AQUÍ Y PAGA AL RECIBIR" }}
            <span class="button-subtext">{{ section.settings.button_subtext | default: "paga en casa contraentrega" }}</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "V10 Hero Section",
  "class": "hyperlab-section",
  "settings": [
    {
      "type": "header",
      "content": "Layout Settings"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full Width Section",
      "default": false
    },
    {
      "type": "header",
      "content": "Content Settings"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "text",
      "id": "headline",
      "label": "Headline",
      "default": "¿TUS HIJOS NO ESTÁN COMIENDO BIEN?"
    },
    {
      "type": "text",
      "id": "subheadline",
      "label": "Subheadline",
      "default": "¡NO TE PREOCUPES MÁS!"
    },
    {
      "type": "image_picker",
      "id": "certification_badge",
      "label": "Certification Badge"
    },
    {
      "type": "header",
      "content": "Gallery Settings"
    },
    {
      "type": "image_picker",
      "id": "image_1",
      "label": "Gallery Image 1 (Featured)"
    },
    {
      "type": "image_picker",
      "id": "image_2",
      "label": "Gallery Image 2"
    },
    {
      "type": "image_picker",
      "id": "image_3",
      "label": "Gallery Image 3"
    },
    {
      "type": "image_picker",
      "id": "image_4",
      "label": "Gallery Image 4"
    },
    {
      "type": "image_picker",
      "id": "image_5",
      "label": "Gallery Image 5"
    },
    {
      "type": "header",
      "content": "Button Settings"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "CLICK AQUÍ Y PAGA AL RECIBIR"
    },
    {
      "type": "text",
      "id": "button_subtext",
      "label": "Button Subtext",
      "default": "paga en casa contraentrega"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button Link"
    },
    {
      "type": "select",
      "id": "button_animation",
      "label": "Button Animation",
      "options": [
        {
          "value": "shake",
          "label": "Shake"
        },
        {
          "value": "pulse",
          "label": "Pulse"
        },
        {
          "value": "bounce",
          "label": "Bounce"
        },
        {
          "value": "none",
          "label": "None"
        }
      ],
      "default": "shake"
    }
  ]
}
{% endschema %}

{% stylesheet %}
.hyperlab-v10-hero {
  padding: 0;
  background-color: #fff;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.hero-content {
  margin: 0 auto;
  padding: 0;
  width: 100%;
  max-width: 100%;
  display: flex;
  flex-direction: column;
  flex: 1;
}

.hero-header {
  text-align: center;
  margin-bottom: 24px;
  padding: 24px 0 0;
}

.logo-container {
  margin: 24px 0;
}

.hero-logo {
  max-width: 120px;
  height: auto;
}

.hero-title {
  font-size: 32px;
  font-weight: 800;
  margin: 0 auto;
  line-height: 1.2;
  color: #1a1a1a;
  max-width: 600px;
  padding: 0 20px;
}

.product-gallery {
  margin: 0 auto;
  width: 100%;
  max-width: 1400px;
  padding: 0 20px;
}

.gallery-container {
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin-bottom: 24px;
}

.main-image-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 50px;
}

.main-image-container {
  width: 100%;
  max-width: 1000px;
  background: #ffffff;
  border-radius: 12px;
  padding: 16px;
}

.main-image {
  position: relative;
  border: 2px solid #ff6b00;
  border-radius: 8px;
  overflow: hidden;
  margin: 0 auto;
}

.featured-image {
  width: 100%;
  height: auto;
  display: block;
  border-radius: 6px;
  padding: 8px;
}

.gallery-nav {
  width: 32px;
  height: 32px;
  border: none;
  background: rgba(255, 107, 0, 0.2);
  color: #ff6b00;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  z-index: 2;
}

.gallery-nav.prev {
  left: 0;
}

.gallery-nav.next {
  right: 0;
}

.gallery-nav:hover {
  background: rgba(255, 107, 0, 0.4);
}

.gallery-nav svg {
  width: 20px;
  height: 20px;
  opacity: 0.8;
}

.thumbnails-container {
  display: flex;
  gap: 8px;
  justify-content: center;
  flex-wrap: nowrap;
  padding: 0 12px;
  overflow-x: auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.thumbnails-container::-webkit-scrollbar {
  display: none;
}

.thumbnail-button {
  width: 60px;
  height: 60px;
  padding: 3px;
  border: 2px solid transparent;
  border-radius: 6px;
  background: #ffffff;
  cursor: pointer;
  overflow: hidden;
  transition: all 0.3s ease;
  flex: 0 0 auto;
}

.thumbnail-button:hover {
  border-color: rgba(255, 107, 0, 0.5);
}

.thumbnail-button.active {
  border-color: #ff6b00;
}

.thumbnail-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 4px;
  padding: 2px;
}

.hero-cta {
  text-align: center;
  padding: 0 20px 32px;
  margin-top: auto;
}

.subheadline-container {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
  margin-bottom: 20px;
}

.subheadline {
  font-size: 24px;
  font-weight: 600;
  margin: 0;
}

.certification-badge {
  flex-shrink: 0;
}

.certification-image {
  max-width: 60px;
  height: auto;
  display: block;
}

.primary-button {
  background-color: #1a1a1a;
  color: white;
  border: none;
  padding: 20px;
  border-radius: 100px;
  font-weight: 700;
  font-size: 20px;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  max-width: 500px;
  margin: 0 auto;
  text-decoration: none;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  min-height: 90px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.button-subtext {
  font-size: 16px;
  opacity: 0.8;
  margin-top: 6px;
  font-weight: 400;
  text-transform: none;
  letter-spacing: 0;
}

@media screen and (min-width: 768px) {
  .hero-title {
    font-size: 42px;
  }

  .gallery-nav {
    width: 50px;
    height: 50px;
  }

  .thumbnail-button {
    width: 120px;
    height: 120px;
  }
}

@media screen and (max-width: 767px) {
  .main-image-wrapper {
    padding: 0 40px;
  }

  .main-image-container {
    padding: 12px;
  }

  .gallery-nav {
    width: 28px;
    height: 28px;
  }

  .gallery-nav svg {
    width: 16px;
    height: 16px;
  }

  .thumbnails-container {
    gap: 6px;
    padding: 0 8px;
  }

  .thumbnail-button {
    width: calc((100% - 24px) / 5);
    height: auto;
    aspect-ratio: 1;
  }

  .primary-button {
    font-size: 18px;
    padding: 16px;
    min-height: 80px;
    max-width: 90%;
  }

  .button-subtext {
    font-size: 14px;
    margin-top: 4px;
  }
}
{% endstylesheet %}

{% javascript %}
document.addEventListener('DOMContentLoaded', function() {
  const mainImage = document.querySelector('.featured-image');
  const thumbnails = document.querySelectorAll('.thumbnail-button');
  const prevButton = document.querySelector('.gallery-nav.prev');
  const nextButton = document.querySelector('.gallery-nav.next');
  let currentIndex = 0;

  function updateMainImage(index) {
    const selectedThumbnail = thumbnails[index];
    if (!selectedThumbnail) return;

    // Update main image with smooth transition
    mainImage.style.opacity = '0';
    setTimeout(() => {
      const imageUrl = selectedThumbnail.dataset.imageUrl;
      const imageAlt = selectedThumbnail.dataset.alt;
      mainImage.src = imageUrl;
      mainImage.alt = imageAlt;
      mainImage.dataset.index = index;
      mainImage.style.opacity = '1';
    }, 150);

    // Update active state
    thumbnails.forEach(thumb => thumb.classList.remove('active'));
    selectedThumbnail.classList.add('active');

    // Scroll thumbnail into view if needed
    selectedThumbnail.scrollIntoView({
      behavior: 'smooth',
      block: 'nearest',
      inline: 'center'
    });

    currentIndex = index;
  }

  // Add smooth transition to main image
  mainImage.style.transition = 'opacity 0.15s ease-in-out';

  // Initialize with first image
  if (thumbnails.length > 0) {
    currentIndex = 0;
    updateMainImage(currentIndex);
  }

  thumbnails.forEach((thumb, index) => {
    thumb.addEventListener('click', () => updateMainImage(index));
  });

  prevButton.addEventListener('click', () => {
    const newIndex = currentIndex - 1;
    if (newIndex >= 0) {
      updateMainImage(newIndex);
    } else {
      updateMainImage(thumbnails.length - 1);
    }
  });

  nextButton.addEventListener('click', () => {
    const newIndex = currentIndex + 1;
    if (newIndex < thumbnails.length) {
      updateMainImage(newIndex);
    } else {
      updateMainImage(0);
    }
  });
});
{% endjavascript %} 