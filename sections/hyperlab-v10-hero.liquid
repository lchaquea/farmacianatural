{%- assign product = all_products[section.settings.product_handle] | default: product -%}
<!-- Updated: May 1, 2024 -->

{% render 'hyperlab-global-styles' %}

<div class="hyperlab-section hyperlab-v10-hero-bg">
  <div class="hyperlab-content">
    <div class="hyperlab-v10-hero {% if section.settings.full_width %}full-width{% endif %}">
      <div class="hero-content {% if section.settings.full_width %}page-width{% endif %}">
        <div class="hero-header">
          <div class="logo-container" style="margin-top: 1px; margin-bottom: 8px;">
            {%- if section.settings.logo != blank -%}
              <img src="{{ section.settings.logo | img_url: '100x' }}" alt="{{ shop.name }}" class="hero-logo">
            {%- endif -%}
          </div>
          
          <h1 class="hero-title">{{ section.settings.headline | default: "¿TUS HIJOS NO ESTÁN COMIENDO BIEN?" }}</h1>
        </div>

        <div class="product-gallery">
          <div class="gallery-container">
            <div class="main-image-wrapper gallery-block">
              <div class="main-image-container">
                <div class="main-image">
                  {%- if section.settings.image_1 != blank -%}
                    <img src="{{ section.settings.image_1 | img_url: '1000x' }}" 
                         alt="{{ section.settings.image_1.alt | escape }}"
                         class="featured-image"
                         data-index="0">
                  {%- endif -%}
                </div>
              </div>
            </div>
            <div class="thumbnails-container gallery-block">
              {%- for i in (1..5) -%}
                {%- assign image_setting = 'image_' | append: i -%}
                {%- assign current_image = section.settings[image_setting] -%}
                {%- if current_image != blank -%}
                  <button class="thumbnail-button {% if forloop.first %}active{% endif %}" 
                          data-image-url="{{ current_image | img_url: '1000x' }}"
                          data-image-index="{{ forloop.index0 }}"
                          data-alt="{{ current_image.alt | escape }}">
                    <img src="{{ current_image | img_url: '1000x1000', crop: 'center' }}" 
                         alt="{{ current_image.alt | escape }}"
                         class="thumbnail-image">
                  </button>
                {%- endif -%}
              {%- endfor -%}
            </div>
          </div>
        </div>

        <div class="hero-cta">
          <div class="subheadline-container">
            <h2 class="subheadline">{{ section.settings.subheadline | default: "¡NO TE PREOCUPES MÁS!" }}</h2>
            {%- if section.settings.certification_badge != blank -%}
              <div class="certification-badge">
                <img src="{{ section.settings.certification_badge | img_url: '100x' }}" 
                     alt="Certificación INVIMA" 
                     class="certification-image">
              </div>
            {%- endif -%}
          </div>
          <a href="{{ section.settings.button_link | default: '#' }}" class="primary-button {{ section.settings.button_animation }}">
            {{ section.settings.button_text | default: "CLICK AQUÍ Y PAGA AL RECIBIR" }}
            <span class="button-subtext">{{ section.settings.button_subtext | default: "paga en casa contraentrega" }}</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "V10 Hero Section",
  "class": "hyperlab-section",
  "settings": [
    {
      "type": "header",
      "content": "Layout Settings"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full Width Section",
      "default": false
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "rgba(255, 107, 0, 0.1)"
    },
    {
      "type": "header",
      "content": "Content Settings"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "text",
      "id": "headline",
      "label": "Headline",
      "default": "¿TUS HIJOS NO ESTÁN COMIENDO BIEN?"
    },
    {
      "type": "text",
      "id": "subheadline",
      "label": "Subheadline",
      "default": "¡NO TE PREOCUPES MÁS!"
    },
    {
      "type": "image_picker",
      "id": "certification_badge",
      "label": "Certification Badge"
    },
    {
      "type": "header",
      "content": "Gallery Settings"
    },
    {
      "type": "image_picker",
      "id": "image_1",
      "label": "Gallery Image 1 (Featured)"
    },
    {
      "type": "image_picker",
      "id": "image_2",
      "label": "Gallery Image 2"
    },
    {
      "type": "image_picker",
      "id": "image_3",
      "label": "Gallery Image 3"
    },
    {
      "type": "image_picker",
      "id": "image_4",
      "label": "Gallery Image 4"
    },
    {
      "type": "image_picker",
      "id": "image_5",
      "label": "Gallery Image 5"
    },
    {
      "type": "header",
      "content": "Button Settings"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "CLICK AQUÍ Y PAGA AL RECIBIR"
    },
    {
      "type": "text",
      "id": "button_subtext",
      "label": "Button Subtext",
      "default": "paga en casa contraentrega"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button Link"
    },
    {
      "type": "select",
      "id": "button_animation",
      "label": "Button Animation",
      "options": [
        { "value": "shake", "label": "Shake" },
        { "value": "pulse", "label": "Pulse" },
        { "value": "bounce", "label": "Bounce" }
      ]
    },
    {
      "type": "range",
      "id": "button_text_size",
      "label": "Button Text Size (px)",
      "min": 14,
      "max": 32,
      "step": 1,
      "default": 22
    },
    {
      "type": "range",
      "id": "button_subtext_size",
      "label": "Button Subtext Size (px)",
      "min": 10,
      "max": 22,
      "step": 1,
      "default": 14
    }
  ]
}
{% endschema %}

{% stylesheet %}
.hyperlab-v10-hero {
  padding: 10px;
  background: #fff;
}

.hero-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  padding-top: 6px;
}

.hero-logo {
  max-width: 60px;
  height: auto;
}

.hero-title {
  font-size: 20px;
  font-weight: 700;
  color: #1a1a1a;
  max-width: 400px;
  margin: 0 auto;
  text-align: center;
}

.product-gallery {
  max-width: 1200px;
  margin: 0 auto;
  padding: 8px;
}

.gallery-container {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-bottom: 12px;
}

.gallery-block {
  width: 400px;
  margin: 0 auto;
}

.main-image-wrapper {
  background: #f8f8f8;
  border-radius: 16px;
  padding: 16px;
  margin-bottom: 12px;
}

.main-image-container {
  width: 100%;
  max-width: 800px;
  background: #ffffff;
  border-radius: 8px;
  padding: 6px;
}

.main-image {
  width: 100%;
  height: auto;
  border-radius: 8px;
}

.gallery-nav {
  width: 24px;
  height: 24px;
  border: none;
  background: rgba(255, 107, 0, 0.2);
  color: #ff6b00;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  z-index: 2;
}

.gallery-nav.prev {
  left: 0;
}

.gallery-nav.next {
  right: 0;
}

.gallery-nav:hover {
  background: rgba(255, 107, 0, 0.4);
}

.gallery-nav svg {
  width: 14px;
  height: 14px;
  opacity: 0.8;
}

.thumbnails-container {
  display: flex;
  gap: 8px;
  justify-content: center;
  margin-top: 8px;
}

.thumbnail-button {
  width: 80px;
  height: 80px;
  padding: 4px;
  border: 1px solid #ddd;
  border-radius: 6px;
  background: #fff;
  cursor: pointer;
  transition: all 0.3s ease;
}

.thumbnail-button:hover {
  border-color: #ff6b00;
}

.thumbnail-button.active {
  border-color: #ff6b00;
  box-shadow: 0 0 0 2px rgba(255, 107, 0, 0.2);
}

.thumbnail-button img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 4px;
}

.hero-cta {
  text-align: center;
  padding: 10px 16px;
  margin-top: 12px;
}

.subheadline-container {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin-bottom: 10px;
}

.subheadline {
  font-size: 16px;
  font-weight: 600;
  margin: 0;
}

.certification-badge {
  flex-shrink: 0;
}

.certification-image {
  max-width: 40px;
  height: auto;
  display: block;
}

.primary-button {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  max-width: 400px;
  min-width: 200px;
  padding: 13px 0 8px 0;
  font-size: {{ section.settings.button_text_size | default: 16 }}px;
  font-weight: 800;
  background: linear-gradient(90deg, #ff6b00 0%, #ff9800 100%);
  color: #fff;
  border: none;
  border-radius: 20px;
  cursor: pointer;
  margin: 18px auto 0 auto;
  transition: background 0.2s, box-shadow 0.2s, transform 0.15s;
  box-shadow: 0 3px 16px rgba(255,107,0,0.13);
  letter-spacing: 0.03em;
  text-align: center;
  white-space: normal;
  text-decoration: none !important;
  outline: none;
}

.primary-button:hover, .primary-button:focus {
  background: linear-gradient(90deg, #ff8500 0%, #ffb74d 100%);
  box-shadow: 0 5px 16px rgba(255,107,0,0.18);
  transform: translateY(-1px) scale(1.02);
  text-decoration: none !important;
}

.button-subtext {
  font-size: {{ section.settings.button_subtext_size | default: 10 }}px;
  opacity: 0.92;
  margin-top: 3px;
  white-space: normal;
  font-weight: 500;
}

@media screen and (min-width: 768px) {
  .hyperlab-v10-hero {
    padding: 15px;
  }

  .hero-header {
    margin-bottom: 15px;
    padding-top: 8px;
  }

  .hero-logo {
    max-width: 70px;
  }

  .hero-title {
    font-size: 24px;
  }

  .product-gallery {
    padding: 12px;
  }

  .gallery-block {
    width: 500px;
  }

  .main-image-wrapper {
    padding: 20px;
  }

  .thumbnail-button {
    width: 90px;
    height: 90px;
  }
}

@media screen and (min-width: 990px) {
  .hyperlab-v10-hero {
    padding: 20px;
  }

  .hero-header {
    margin-bottom: 20px;
    padding-top: 10px;
  }

  .hero-logo {
    max-width: 80px;
  }

  .hero-title {
    font-size: 28px;
  }

  .product-gallery {
    padding: 15px;
  }

  .gallery-block {
    width: 600px;
  }

  .main-image-wrapper {
    padding: 24px;
  }

  .thumbnail-button {
    width: 100px;
    height: 100px;
  }
}

.announcement-bar,
.announcement-bar-section,
.announcement-bar[class*="section-"] {
  padding-bottom: 0 !important;
  margin-bottom: 0 !important;
}

.hyperlab-section,
.hyperlab-content,
.hyperlab-v10-hero-bg,
.hyperlab-v10-hero,
.hero-content,
.hero-header {
  padding-top: 0 !important;
  margin-top: 0 !important;
}

.hyperlab-v10-hero {
  padding-bottom: 4px !important;
}

/* --- Responsive main image container and image --- */
.main-image-wrapper,
.gallery-block,
.main-image-container {
  width: 100%;
  max-width: 98vw;
  padding-left: 0;
  padding-right: 0;
  box-sizing: border-box;
}

.main-image img,
.featured-image {
  width: 100%;
  max-width: 100%;
  height: auto;
  display: block;
  margin: 0 auto;
}

@media screen and (max-width: 767px) {
  .main-image-wrapper,
  .gallery-block,
  .main-image-container {
    padding: 1vw 0;
    max-width: 100vw;
  }
}
{% endstylesheet %}

{% javascript %}
document.addEventListener('DOMContentLoaded', function() {
  const mainImage = document.querySelector('.featured-image');
  const thumbnails = document.querySelectorAll('.thumbnail-button');
  const prevButton = document.querySelector('.gallery-nav.prev');
  const nextButton = document.querySelector('.gallery-nav.next');
  let currentIndex = 0;

  function updateMainImage(index, direction = null) {
    const selectedThumbnail = thumbnails[index];
    if (!selectedThumbnail) return;

    // Update main image with smooth transition
    const transitionClass = direction === 'prev' ? 'slide-right' : direction === 'next' ? 'slide-left' : '';
    mainImage.style.opacity = '0';
    
    setTimeout(() => {
      const imageUrl = selectedThumbnail.dataset.imageUrl;
      const imageAlt = selectedThumbnail.dataset.alt;
      mainImage.src = imageUrl;
      mainImage.alt = imageAlt;
      mainImage.dataset.index = index;
      if (transitionClass) mainImage.classList.add(transitionClass);
      mainImage.style.opacity = '1';
      
      setTimeout(() => {
        if (transitionClass) mainImage.classList.remove(transitionClass);
      }, 300);
    }, 150);

    // Update active state
    thumbnails.forEach(thumb => thumb.classList.remove('active'));
    selectedThumbnail.classList.add('active');

    // Scroll thumbnail into view if needed
    selectedThumbnail.scrollIntoView({
      behavior: 'smooth',
      block: 'nearest',
      inline: 'center'
    });

    currentIndex = index;
  }

  // Add smooth transition to main image
  mainImage.style.transition = 'opacity 0.15s ease-in-out';

  // Initialize with first image
  if (thumbnails.length > 0) {
    currentIndex = 0;
    updateMainImage(currentIndex);
  }

  thumbnails.forEach((thumb, index) => {
    thumb.addEventListener('click', () => updateMainImage(index));
  });

  prevButton.addEventListener('click', () => {
    const newIndex = currentIndex - 1;
    if (newIndex >= 0) {
      updateMainImage(newIndex, 'prev');
    } else {
      updateMainImage(thumbnails.length - 1, 'prev');
    }
  });

  nextButton.addEventListener('click', () => {
    const newIndex = currentIndex + 1;
    if (newIndex < thumbnails.length) {
      updateMainImage(newIndex, 'next');
    } else {
      updateMainImage(0, 'next');
    }
  });

  // Add keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') {
      prevButton.click();
    } else if (e.key === 'ArrowRight') {
      nextButton.click();
    }
  });
});
{% endjavascript %} 