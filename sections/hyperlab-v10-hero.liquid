{%- assign product = all_products[section.settings.product_handle] | default: product -%}
<!-- Updated: May 1, 2024 -->

{% render 'hyperlab-global-styles' %}

<div class="hyperlab-section hyperlab-v10-hero-bg">
  <div class="hyperlab-content">
    <div class="hyperlab-v10-hero {% if section.settings.full_width %}full-width{% endif %}">
      <div class="hero-content {% if section.settings.full_width %}page-width{% endif %}">
        <div class="hero-header">
          <div class="logo-container" style="margin-top: 1px; margin-bottom: 8px;">
            {%- if section.settings.logo != blank -%}
              <img src="{{ section.settings.logo | img_url: '100x' }}" alt="{{ shop.name }}" class="hero-logo">
            {%- endif -%}
          </div>
          
          <h1 class="hero-title">{{ section.settings.headline | default: "¿TUS HIJOS NO ESTÁN COMIENDO BIEN?" }}</h1>
        </div>

        <div class="product-gallery">
          <div class="gallery-container">
            <div class="main-image-wrapper gallery-block">
              <div class="main-image-container">
                <div class="main-image">
                  {%- if section.settings.image_1 != blank -%}
                    <img src="{{ section.settings.image_1 | img_url: '1000x' }}" 
                         alt="{{ section.settings.image_1.alt | escape }}"
                         class="featured-image"
                         data-index="0">
                  {%- endif -%}
                </div>
              </div>
            </div>
            <div class="thumbnails-container gallery-block">
              {%- for i in (1..5) -%}
                {%- assign image_setting = 'image_' | append: i -%}
                {%- assign current_image = section.settings[image_setting] -%}
                {%- if current_image != blank -%}
                  <button class="thumbnail-button {% if forloop.first %}active{% endif %}" 
                          data-image-url="{{ current_image | img_url: '1000x' }}"
                          data-image-index="{{ forloop.index0 }}"
                          data-alt="{{ current_image.alt | escape }}">
                    <img src="{{ current_image | img_url: '1000x1000', crop: 'center' }}" 
                         alt="{{ current_image.alt | escape }}"
                         class="thumbnail-image">
                  </button>
                {%- endif -%}
              {%- endfor -%}
            </div>
          </div>
        </div>

        <div class="hero-cta">
          <div class="subheadline-container">
            <h2 class="subheadline">{{ section.settings.subheadline | default: "¡NO TE PREOCUPES MÁS!" }}</h2>
            {%- if section.settings.certification_badge != blank -%}
              <div class="certification-badge">
                <img src="{{ section.settings.certification_badge | img_url: '100x' }}" 
                     alt="Certificación INVIMA" 
                     class="certification-image">
              </div>
            {%- endif -%}
          </div>
          <a href="{{ section.settings.button_link | default: '#' }}" class="primary-button {{ section.settings.button_animation }}">
            {{ section.settings.button_text | default: "CLICK AQUÍ Y PAGA AL RECIBIR" }}
            <span class="button-subtext">{{ section.settings.button_subtext | default: "paga en casa contraentrega" }}</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "V10 Hero Section",
  "class": "hyperlab-section",
  "settings": [
    {
      "type": "header",
      "content": "Layout Settings"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full Width Section",
      "default": false
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "rgba(255, 107, 0, 0.1)"
    },
    {
      "type": "header",
      "content": "Content Settings"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "text",
      "id": "headline",
      "label": "Headline",
      "default": "¿TUS HIJOS NO ESTÁN COMIENDO BIEN?"
    },
    {
      "type": "text",
      "id": "subheadline",
      "label": "Subheadline",
      "default": "¡NO TE PREOCUPES MÁS!"
    },
    {
      "type": "image_picker",
      "id": "certification_badge",
      "label": "Certification Badge"
    },
    {
      "type": "header",
      "content": "Gallery Settings"
    },
    {
      "type": "image_picker",
      "id": "image_1",
      "label": "Gallery Image 1 (Featured)"
    },
    {
      "type": "image_picker",
      "id": "image_2",
      "label": "Gallery Image 2"
    },
    {
      "type": "image_picker",
      "id": "image_3",
      "label": "Gallery Image 3"
    },
    {
      "type": "image_picker",
      "id": "image_4",
      "label": "Gallery Image 4"
    },
    {
      "type": "image_picker",
      "id": "image_5",
      "label": "Gallery Image 5"
    },
    {
      "type": "header",
      "content": "Button Settings"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "CLICK AQUÍ Y PAGA AL RECIBIR"
    },
    {
      "type": "text",
      "id": "button_subtext",
      "label": "Button Subtext",
      "default": "paga en casa contraentrega"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button Link"
    },
    {
      "type": "select",
      "id": "button_animation",
      "label": "Button Animation",
      "options": [
        { "value": "shake", "label": "Shake" },
        { "value": "pulse", "label": "Pulse" },
        { "value": "bounce", "label": "Bounce" }
      ]
    },
    {
      "type": "range",
      "id": "button_text_size",
      "label": "Button Text Size (px)",
      "min": 14,
      "max": 32,
      "step": 1,
      "default": 22
    },
    {
      "type": "range",
      "id": "button_subtext_size",
      "label": "Button Subtext Size (px)",
      "min": 10,
      "max": 22,
      "step": 1,
      "default": 14
    }
  ]
}
{% endschema %}

{% stylesheet %}
.hyperlab-v10-hero {
  padding: 0;
  background-color: {{ section.settings.background_color }};
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.hyperlab-v10-hero-bg {
  background: linear-gradient(180deg, #ffe0b2 0%, #ffb74d 100%);
  background-color: #ffe0b2;
  background-image: url('data:image/svg+xml;utf8,<svg width="180" height="180" viewBox="0 0 180 180" fill="none" xmlns="http://www.w3.org/2000/svg"><g opacity="0.28"><polygon points="30,20 34,32 47,32 36,40 40,52 30,44 20,52 24,40 13,32 26,32" fill="%23fff"/><path d="M120 40 Q125 45 130 40 Q135 35 130 30 Q125 25 120 30 Q115 35 120 40 Z" fill="%23fff"/><path d="M80 120 Q85 125 90 120 Q95 115 90 110 Q85 105 80 110 Q75 115 80 120 Z" fill="%23fff"/><path d="M150 100 Q155 105 160 100 Q165 95 160 90 Q155 85 150 90 Q145 95 150 100 Z" fill="%23fff"/><path d="M60 60 Q62 62 64 60 Q66 58 64 56 Q62 54 60 56 Q58 58 60 60 Z" fill="%23fff"/><path d="M110 150 Q112 152 114 150 Q116 148 114 146 Q112 144 110 146 Q108 148 110 150 Z" fill="%23fff"/><path d="M50 150 Q55 155 60 150 Q65 145 60 140 Q55 135 50 140 Q45 145 50 150 Z" fill="%23fff"/><path d="M140 30 Q142 32 144 30 Q146 28 144 26 Q142 24 140 26 Q138 28 140 30 Z" fill="%23fff"/><path d="M90 60 Q92 62 94 60 Q96 58 94 56 Q92 54 90 56 Q88 58 90 60 Z" fill="%23fff"/><path d="M120 120 Q122 122 124 120 Q126 118 124 116 Q122 114 120 116 Q118 118 120 120 Z" fill="%23fff"/><path d="M60 100 Q62 102 64 100 Q66 98 64 96 Q62 94 60 96 Q58 98 60 100 Z" fill="%23fff"/><path d="M90 30 Q92 32 94 30 Q96 28 94 26 Q92 24 90 26 Q88 28 90 30 Z" fill="%23fff"/><path d="M150 150 Q155 155 160 150 Q165 145 160 140 Q155 135 150 140 Q145 145 150 150 Z" fill="%23fff"/></g></svg>');
  background-size: 180px 180px;
  background-repeat: repeat;
  border-radius: 0;
}

.hero-content {
  margin: 0 auto;
  padding: 0;
  width: 100%;
  max-width: 100%;
  display: flex;
  flex-direction: column;
  flex: 1;
}

.hero-header {
  text-align: center;
  margin-bottom: 24px;
  padding-top: 12px;
}

.logo-container {
  display: flex;
  justify-content: center;
  align-items: center;
  margin-top: 24px;
  margin-bottom: 8px;
}

.hero-logo {
  max-width: 80px;
  height: auto;
}

.hero-title {
  font-size: 32px;
  font-weight: 800;
  margin-top: 0;
  margin-bottom: 0;
  line-height: 1.2;
  color: #1a1a1a;
  max-width: 600px;
  padding: 0 20px;
}

.product-gallery {
  margin: 0 auto;
  width: 100%;
  max-width: 2000px;
  padding: 0 20px;
}

.gallery-container {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 24px;
}

.gallery-block {
  width: 600px;
  max-width: 95vw;
  margin-left: auto;
  margin-right: auto;
  display: flex;
  justify-content: center;
  align-items: center;
}

.main-image-wrapper {
  background: #fff;
  border-radius: 32px 32px 0 0;
  box-shadow: 0 4px 32px rgba(0,0,0,0.07);
  padding: 32px 32px 24px 32px;
  margin-bottom: 0;
}

.main-image-container {
  width: 100%;
  max-width: 1562px;
  background: #ffffff;
  border-radius: 15px;
  padding: 12px;
}

.main-image {
  position: relative;
  border: 2px solid #ff6b00;
  border-radius: 10px;
  overflow: hidden;
  margin: 0 auto;
}

.main-image img,
.featured-image {
  width: 600px;
  max-width: 100%;
  height: auto;
  display: block;
  margin: 0 auto;
}

.gallery-nav {
  width: 32px;
  height: 32px;
  border: none;
  background: rgba(255, 107, 0, 0.2);
  color: #ff6b00;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  z-index: 2;
}

.gallery-nav.prev {
  left: 0;
}

.gallery-nav.next {
  right: 0;
}

.gallery-nav:hover {
  background: rgba(255, 107, 0, 0.4);
}

.gallery-nav svg {
  width: 20px;
  height: 20px;
  opacity: 0.8;
}

.thumbnails-container {
  background: #fff;
  border-radius: 0 0 32px 32px;
  box-shadow: 0 4px 32px rgba(0,0,0,0.07);
  padding: 12px 32px 16px 32px;
  gap: 16px;
  margin-top: 0;
  margin-bottom: 16px;
  width: 600px;
  max-width: 95vw;
  display: flex;
  justify-content: center;
  align-items: center;
}

.thumbnail-button {
  width: 112px;
  height: 112px;
  padding: 2px;
  border: 2px solid transparent;
  border-radius: 12px;
  background: #fff;
  cursor: pointer;
  overflow: hidden;
  transition: all 0.3s cubic-bezier(.4,0,.2,1);
  flex: 0 0 auto;
  box-shadow: 0 2px 8px rgba(0,0,0,0.04);
}

.thumbnail-button.active {
  border-color: #ff6b00;
  box-shadow: 0 4px 16px rgba(255,107,0,0.10);
}

.thumbnail-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 8px;
  padding: 0;
}

.hero-cta {
  text-align: center;
  padding: 0 20px 32px;
  margin-top: auto;
}

.subheadline-container {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
  margin-bottom: 20px;
}

.subheadline {
  font-size: 24px;
  font-weight: 600;
  margin: 0;
}

.certification-badge {
  flex-shrink: 0;
}

.certification-image {
  max-width: 60px;
  height: auto;
  display: block;
}

.primary-button {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  max-width: 600px;
  min-width: 260px;
  padding: 26px 0 16px 0;
  font-size: {{ section.settings.button_text_size | default: 22 }}px;
  font-weight: 800;
  background: linear-gradient(90deg, #ff6b00 0%, #ff9800 100%);
  color: #fff;
  border: none;
  border-radius: 40px;
  cursor: pointer;
  margin: 36px auto 0 auto;
  transition: background 0.2s, box-shadow 0.2s, transform 0.15s;
  box-shadow: 0 6px 32px rgba(255,107,0,0.13);
  letter-spacing: 0.03em;
  text-align: center;
  white-space: normal;
  text-decoration: none !important;
  outline: none;
}

.primary-button:hover, .primary-button:focus {
  background: linear-gradient(90deg, #ff8500 0%, #ffb74d 100%);
  box-shadow: 0 10px 32px rgba(255,107,0,0.18);
  transform: translateY(-2px) scale(1.03);
  text-decoration: none !important;
}

.button-subtext {
  font-size: {{ section.settings.button_subtext_size | default: 14 }}px;
  opacity: 0.92;
  margin-top: 6px;
  white-space: normal;
  font-weight: 500;
}

@media screen and (min-width: 768px) {
  .hero-title {
    font-size: 42px;
  }

  .gallery-nav {
    width: 50px;
    height: 50px;
  }

  .thumbnail-button {
    width: 120px;
    height: 120px;
  }
}

@media screen and (max-width: 767px) {
  .gallery-block,
  .main-image-wrapper,
  .thumbnails-container {
    width: 98vw;
    max-width: 98vw;
    padding-left: 2vw;
    padding-right: 2vw;
  }
  .thumbnail-button {
    width: 18vw;
    height: 18vw;
    min-width: 60px;
    min-height: 60px;
    max-width: 100px;
    max-height: 100px;
  }

  .gallery-nav {
    width: 28px;
    height: 28px;
  }

  .gallery-nav svg {
    width: 16px;
    height: 16px;
  }

  .primary-button {
    width: 100%;
    max-width: 98vw;
    min-width: 0;
    font-size: {{ section.settings.button_text_size | default: 18 }}px;
    padding: 18px 0 10px 0;
  }

  .button-subtext {
    font-size: {{ section.settings.button_subtext_size | default: 12 }}px;
  }

  .logo-container {
    margin-top: 16px;
  }

  .main-image img,
  .featured-image {
    width: 100%;
    max-width: 320px;
  }
}

.announcement-bar,
.announcement-bar-section,
.announcement-bar[class*="section-"] {
  padding-bottom: 0 !important;
  margin-bottom: 0 !important;
}

.hyperlab-section,
.hyperlab-content,
.hyperlab-v10-hero-bg,
.hyperlab-v10-hero,
.hero-content,
.hero-header {
  padding-top: 0 !important;
  margin-top: 0 !important;
}

.hyperlab-v10-hero {
  padding-bottom: 16px !important;
}

/* --- Responsive main image container and image --- */
.main-image-wrapper,
.gallery-block,
.main-image-container {
  width: 100%;
  max-width: 98vw;
  padding-left: 0;
  padding-right: 0;
  box-sizing: border-box;
}

.main-image img,
.featured-image {
  width: 100%;
  max-width: 100%;
  height: auto;
  display: block;
  margin: 0 auto;
}

@media screen and (max-width: 767px) {
  .main-image-wrapper,
  .gallery-block,
  .main-image-container {
    padding: 2vw 0;
    max-width: 100vw;
  }
}
{% endstylesheet %}

{% javascript %}
document.addEventListener('DOMContentLoaded', function() {
  const mainImage = document.querySelector('.featured-image');
  const thumbnails = document.querySelectorAll('.thumbnail-button');
  const prevButton = document.querySelector('.gallery-nav.prev');
  const nextButton = document.querySelector('.gallery-nav.next');
  let currentIndex = 0;

  function updateMainImage(index, direction = null) {
    const selectedThumbnail = thumbnails[index];
    if (!selectedThumbnail) return;

    // Update main image with smooth transition
    const transitionClass = direction === 'prev' ? 'slide-right' : direction === 'next' ? 'slide-left' : '';
    mainImage.style.opacity = '0';
    
    setTimeout(() => {
      const imageUrl = selectedThumbnail.dataset.imageUrl;
      const imageAlt = selectedThumbnail.dataset.alt;
      mainImage.src = imageUrl;
      mainImage.alt = imageAlt;
      mainImage.dataset.index = index;
      if (transitionClass) mainImage.classList.add(transitionClass);
      mainImage.style.opacity = '1';
      
      setTimeout(() => {
        if (transitionClass) mainImage.classList.remove(transitionClass);
      }, 300);
    }, 150);

    // Update active state
    thumbnails.forEach(thumb => thumb.classList.remove('active'));
    selectedThumbnail.classList.add('active');

    // Scroll thumbnail into view if needed
    selectedThumbnail.scrollIntoView({
      behavior: 'smooth',
      block: 'nearest',
      inline: 'center'
    });

    currentIndex = index;
  }

  // Add smooth transition to main image
  mainImage.style.transition = 'opacity 0.15s ease-in-out';

  // Initialize with first image
  if (thumbnails.length > 0) {
    currentIndex = 0;
    updateMainImage(currentIndex);
  }

  thumbnails.forEach((thumb, index) => {
    thumb.addEventListener('click', () => updateMainImage(index));
  });

  prevButton.addEventListener('click', () => {
    const newIndex = currentIndex - 1;
    if (newIndex >= 0) {
      updateMainImage(newIndex, 'prev');
    } else {
      updateMainImage(thumbnails.length - 1, 'prev');
    }
  });

  nextButton.addEventListener('click', () => {
    const newIndex = currentIndex + 1;
    if (newIndex < thumbnails.length) {
      updateMainImage(newIndex, 'next');
    } else {
      updateMainImage(0, 'next');
    }
  });

  // Add keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') {
      prevButton.click();
    } else if (e.key === 'ArrowRight') {
      nextButton.click();
    }
  });
});
{% endjavascript %} 